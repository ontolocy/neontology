# Development

## Setup

This project uses uv for development.

```bash
uv sync
uv build
```

## Testing

Pytest is used for testing.

Run all the tests (stopping as soon as something fails):

```bash
uv run pytest -x
```

Many of the tests require access to a database instance. These are identified with the 'uses_graph' mark. We can skip these tests like this:

```bash
uv run pytest -m "not uses_graph"
```

Tests are run against the different supported graph engines. You can use `-k` to run against a specific engine only:

```bash
uv run pytest -k 'networkx-engine'     # only run against the memgraph engine
uv run pytest -k 'memgraph-engine'     # only run against the memgraph engine
uv run pytest -k 'not neo4j-engine'        # don't run against Neo4j
```

A small subset of tests include benchmarking (with [pytest-benchmark](https://pytest-benchmark.readthedocs.io/en/latest/usage.html)). Running these tests can be controlled with:

`--benchmark-skip` - Skip running any tests that contain benchmarks.

`--benchmark-disable` - Disable benchmarks. Benchmarked functions are only ran once and no stats are reported. Use this if you want to run the test but donâ€™t do any benchmarking.

`--benchmark-only` - Only run benchmarks.

Check coverage with:

```bash
uv run pytest --cov=src/neontology
uv run pytest --cov=src/neontology --cov-report=html
```

Generated report is at `htmlcov/index.html` or view as a locally hosted version:

```bash
python -m http.server --directory htmlcov
```

## Linting and Formatting

Use ruff:

```bash
uv run ruff check src
uv run ruff check --fix src
uv run ruff format --check --diff src
uv run ruff format src
```

## Documentation

The documentation is built with mkdocs.

```bash
uv run mkdocs serve    # see how the docs look during development
uv run mkdocs build    # generate the documentation as a static html site
```

## Release

Increment the version, push to Github and upload to pypi!

```bash
git tag va.b.c
git push origin va.b.c # triggers the github action to build & upload to pypi
```
